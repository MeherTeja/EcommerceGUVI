import json
from decimal import Decimal
import boto3
dynamodb=boto3.resource('dynamodb')
table=dynamodb.Table('truck_api_data')
def lambda_handler(event, context):
    # TODO implement
    truck_id=event['truck_id']
    latitude=event['latitude']
    longitude=event['longitude']
    altitude=event['altitude']
    speed=event['speed']
    vehicle_speed=event['vehicle_speed']
    engine_rpm=event['engine_rpm']
    fuel_level=event['fuel_level']
    temp=event['temp']
    oil_pressure=event['oil_pressure']
    battery_voltage=event['battery_voltage']
    odometer_reading=event['odometer_reading']
    fuel_consumption=event['fuel_consumption']
    brake_status=event['brake_status']
    front_left=event['front_left']
    front_right=event['front_right']
    rear_left=event['rear-left']
    rear_right=event['rear_right']
    transmission=event['transmission']
    temp1=event['temp1']
    humidity=event['humidity']
    atmospheric_pressure=event['atmospheric_pressure']
    ts=event['timestamp']
    latitude=json.loads(json.dumps(latitude), parse_float=Decimal)
    longitude=json.loads(json.dumps(longitude), parse_float=Decimal)
    altitude=json.loads(json.dumps(altitude), parse_float=Decimal)
    speed=json.loads(json.dumps(speed), parse_float=Decimal)
    vehicle_speed=json.loads(json.dumps(vehicle_speed), parse_float=Decimal)
    engine_rpm=json.loads(json.dumps(engine_rpm), parse_float=Decimal)
    fuel_level=json.loads(json.dumps(fuel_level), parse_float=Decimal)
    temp=json.loads(json.dumps(temp), parse_float=Decimal)
    oil_pressure=json.loads(json.dumps(oil_pressure), parse_float=Decimal)
    battery_voltage=json.loads(json.dumps(battery_voltage), parse_float=Decimal)
    odometer_reading=json.loads(json.dumps(odometer_reading), parse_float=Decimal)
    fuel_consumption=json.loads(json.dumps(fuel_consumption), parse_float=Decimal)
    front_left=json.loads(json.dumps(front_left), parse_float=Decimal)
    front_right=json.loads(json.dumps(front_right), parse_float=Decimal)
    rear_left=json.loads(json.dumps(rear_left), parse_float=Decimal)
    rear_right=json.loads(json.dumps(rear_right), parse_float=Decimal)
    temp1=json.loads(json.dumps(temp1), parse_float=Decimal)
    humidity=json.loads(json.dumps(humidity), parse_float=Decimal)
    atmospheric_pressure=json.loads(json.dumps(atmospheric_pressure), parse_float=Decimal)
    print('events are:',event)
    r1=table.put_item(Item={
        'truck_id':truck_id,
        'latitude':latitude,
        'longitude':longitude,
        'altitude':altitude,
        'speed':speed,
        'vehicle_speed':vehicle_speed,
        'engine_rpm':engine_rpm,
        'fuel_level':fuel_level,
        'temperature':temp,
        'oil_pressure':oil_pressure,
        'battery_voltage':battery_voltage,
        'odometer_reading':odometer_reading,
        'fuel_cons':fuel_consumption,
        'brake_status':brake_status,
        'front_left':front_left,
        'front_right':front_right,
        'rear_left':rear_left,
        'rear_right':rear_right,
        'trans_status':transmission,
        'temp1':temp1,
        'humid':humidity,
        'atmos_press':atmospheric_pressure,
        'timestamp':ts
        })
    return r1
